<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>Pramin - Envie Vídeo</title>
</head>
<body>
<h1>Pramin - Envie seu vídeo</h1>
<input type="file" id="videoInput" accept="video/*">
<button id="uploadBtn">Gerar Link</button>
<p id="status"></p>
<p id="link"></p>

<script>
const uploadBtn = document.getElementById('uploadBtn');
const fileInput = document.getElementById('videoInput');
const status = document.getElementById('status');
const linkOutput = document.getElementById('link');

// Coloque seu token do Dropbox aqui
const DROPBOX_TOKEN = "sl.u.AGQ8iyPhlwQqGctnisZM445CZVZ2akc43vRajWFCLVe_0CdHxK435ZXeRH3xxvzTopcw0cln8QKzRsXoHwEtSD6vFwh7zDRyiId9cDf-TU1C3zqOpr0I9AteCRz7k3SLgFu3H_hdfCo7W46-yzHKV3zgBEjpPtg9UlmQ5VFdbimlg44OgghIDIXqbbGqKGovN6RutH-skQgL1i6cM91vUzJGYKhGm7cQC8Pzu6_oXHDtv1Kr_phALpt3rmttAW_brxnjva37u0Ze0d1NoMKyaEUjs55A-SrLwecizJywehucIVhxeYaWfn-jMeGGBGpLiCYSGew7suqpqwx60fC5CbO0okri3bT4m9drjYDqgf1Cw0DhJpvgrBokkkFeIrol-f8RnZFcKubrUrl4pD4Gu0CBqp21l8EM0esM-JSXmytMeTq4IKb9_CV5-KqzqNlWWBk9cgnhYcvjEreBlwMXHagFJttWrP4g9AQVqoVaLtxd0PJN6t9YwJd22IbyBUZqcGpxvS6dB8uylht6XnACoMXEBL1hYb7pWlaNDwWSnlaxx-rTN3-pAVUc8YY6GWps9rrJxOLM_r9vfBbMK6OFp4W5-ITYgWB3P9QZwX66wyMDUQjbRJyAXN4wmlGvDTkzy5TWrPXn8geJYYg-VMk3CP5cG2WObHznWxvIKuX_nRpyUswcY03TOViiAjNv2_H4JY_5HowAnyiI-IEArLjnx60iEgMZIu2cEPRz6gpcqvPLoONN9WIf_3DG0HVukNrR-i2xpfYTKOG8_SwP-zB2gRCkbgqR2hBOWzy0x7C8ILOOF6gYGgzo9ERhKUmMpTBZuBOBsIq_EtlWhYsaKh2vnJpE_M092509EEbGZPKg27jFGBJYxxDHbgLz75ejxM2WaCo-lIdwctGDGY6m7dP7UxDwEDcr0j1X2vDhtcuKs4fgah3JAuE4Tnj8luFjteTCoGWSk9lKlzQV1h_vKDw2oElGJPPdoYakZ_j-lekZnGYfFDWg705Ee_B5Vg789YFAq2E4R9gsJMcBJgLh2k3tiiq4zFhBGYrnTx8zW7HSQ1k-BDvvCUZ71wAJa2lzRMwjDZknqF1wS0EWD4tfJ-H7VHIJDBMl9cnY9xZw7-7ZdHjFvigvZzq9b5l8S39_sxu68QJ88PYb8BJJ1cxj9FArEt8768aWtzyo48pN8OGUzjd8mxuPJNbsmPMM3wwrro24ODR0gFPAEGfvId1waO9I2ao1ByoFXDz2t5BKAJduk8YuWUYhpr7E0nih3gwdeTsWsOE";

uploadBtn.addEventListener('click', async () => {
  if(fileInput.files.length === 0){
    alert("Escolha um vídeo primeiro!");
    return;
  }

  const file = fileInput.files[0];
  const reader = new FileReader();
  status.textContent = "Upload em andamento...";

  reader.onload = async function(e){
    const base64 = e.target.result.split(',')[1];

    try {
      const response = await fetch('https://content.dropboxapi.com/2/files/upload', {
        method: 'POST',
        headers: {
          "Authorization": "Bearer " + DROPBOX_TOKEN,
          "Dropbox-API-Arg": JSON.stringify({
            path: "/" + file.name,
            mode: "add",
            autorename: true,
            mute: false
          }),
          "Content-Type": "application/octet-stream"
        },
        body: Uint8Array.from(atob(base64), c => c.charCodeAt(0))
      });

      if(response.ok){
        // Gerar link compartilhável
        const linkRes = await fetch('https://api.dropboxapi.com/2/sharing/create_shared_link_with_settings', {
          method: 'POST',
          headers: {
            "Authorization": "Bearer " + DROPBOX_TOKEN,
            "Content-Type": "application/json"
          },
          body: JSON.stringify({path: "/" + file.name})
        });

        const linkData = await linkRes.json();
        status.textContent = "Upload concluído!";
        linkOutput.innerHTML = `<a href="${linkData.url.replace("?dl=0","?dl=1")}" target="_blank">${linkData.url.replace("?dl=0","?dl=1")}</a>`;
      } else {
        status.textContent = "Erro no upload";
      }
    } catch(err){
      status.textContent = "Erro: " + err.message;
    }
  };

  reader.readAsDataURL(file);
});
</script>
</body>
</html>